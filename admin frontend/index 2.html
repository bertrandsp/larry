<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Larry Admin Frontend</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body class="bg-gray-50">
    <div class="min-h-screen">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
            <!-- Header -->
            <div class="mb-8">
                <h1 class="text-4xl font-bold text-gray-900 mb-2">
                    Larry Admin Frontend
                </h1>
                <p class="text-lg text-gray-600">
                    Vocabulary Generator Playground
                </p>
            </div>

            <!-- Navigation -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow" onclick="showSection('generate')">
                    <div class="flex items-center mb-4">
                        <div class="p-3 rounded-lg bg-blue-500 mr-4">
                            <i data-lucide="zap" class="w-6 h-6 text-white"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900">Content Generation</h3>
                    </div>
                    <p class="text-gray-600">Generate vocabulary terms and facts</p>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow" onclick="showSection('moderation')">
                    <div class="flex items-center mb-4">
                        <div class="p-3 rounded-lg bg-yellow-500 mr-4">
                            <i data-lucide="shield" class="w-6 h-6 text-white"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900">Moderation</h3>
                    </div>
                    <p class="text-gray-600">Review and moderate flagged content</p>
                </div>

                <div class="bg-white rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-shadow" onclick="showSection('analytics')">
                    <div class="flex items-center mb-4">
                        <div class="p-3 rounded-lg bg-green-500 mr-4">
                            <i data-lucide="bar-chart-3" class="w-6 h-6 text-white"></i>
                        </div>
                        <h3 class="text-lg font-semibold text-gray-900">Analytics</h3>
                    </div>
                    <p class="text-gray-600">View system metrics and usage</p>
                </div>
            </div>

            <!-- Content Generation Section -->
            <div id="generate-section" class="section hidden">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-2xl font-semibold text-gray-900 mb-6">Content Generation</h2>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Parameters Panel -->
                        <div class="lg:col-span-1">
                            <div class="space-y-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Topic</label>
                                    <input type="text" id="topic" value="artificial intelligence" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Pipeline Strategy</label>
                                    <select id="pipeline" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="source-first">Source-First</option>
                                        <option value="openai-first">OpenAI-First</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Number of Terms</label>
                                    <input type="number" id="numTerms" value="5" min="1" max="50"
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Definition Style</label>
                                    <select id="definitionStyle" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="casual">Casual</option>
                                        <option value="formal" selected>Formal</option>
                                        <option value="technical">Technical</option>
                                        <option value="academic">Academic</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Term Selection Level</label>
                                    <select id="termSelectionLevel" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="beginner">Beginner</option>
                                        <option value="intermediate" selected>Intermediate</option>
                                        <option value="advanced">Advanced</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Definition Complexity Level</label>
                                    <select id="definitionComplexityLevel" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="beginner">Beginner</option>
                                        <option value="intermediate" selected>Intermediate</option>
                                        <option value="advanced">Advanced</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Number of Examples</label>
                                    <input type="number" id="numExamples" value="2" min="1" max="5"
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Number of Facts</label>
                                    <input type="number" id="numFacts" value="5" min="1" max="20"
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Sentence Range</label>
                                    <select id="sentenceRange" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="1-2">1-2 sentences</option>
                                        <option value="2-3" selected>2-3 sentences</option>
                                        <option value="3-4">3-4 sentences</option>
                                        <option value="2-4">2-4 sentences</option>
                                    </select>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Domain Context</label>
                                    <input type="text" id="domainContext" value="general" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                           placeholder="e.g., business, academic, casual">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Language</label>
                                    <select id="language" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <option value="English" selected>English</option>
                                        <option value="Spanish">Spanish</option>
                                        <option value="French">French</option>
                                        <option value="German">German</option>
                                        <option value="Italian">Italian</option>
                                    </select>
                                </div>

                                <!-- Advanced Toggles Section -->
                                <div class="border-t pt-4">
                                    <h4 class="text-lg font-medium text-gray-900 mb-4">Advanced Options</h4>
                                    
                                    <div class="space-y-3">
                                        <label class="flex items-center">
                                            <input type="checkbox" id="useAnalogy" checked class="mr-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-sm text-gray-700">Include Analogies</span>
                                        </label>
                                        
                                        <label class="flex items-center">
                                            <input type="checkbox" id="includeSynonyms" checked class="mr-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-sm text-gray-700">Include Synonyms</span>
                                        </label>
                                        
                                        <label class="flex items-center">
                                            <input type="checkbox" id="includeAntonyms" class="mr-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-sm text-gray-700">Include Antonyms</span>
                                        </label>
                                        
                                        <label class="flex items-center">
                                            <input type="checkbox" id="includeRelatedTerms" checked class="mr-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-sm text-gray-700">Include Related Terms</span>
                                        </label>
                                        
                                        <label class="flex items-center">
                                            <input type="checkbox" id="includeEtymology" class="mr-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-sm text-gray-700">Include Etymology</span>
                                        </label>
                                        
                                        <label class="flex items-center">
                                            <input type="checkbox" id="highlightRootWords" class="mr-3 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                                            <span class="text-sm text-gray-700">Highlight Root Words</span>
                                        </label>
                                    </div>
                                </div>

                                <button onclick="generateContent()" id="generateBtn"
                                        class="w-full bg-blue-600 text-white py-3 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed">
                                    Generate Content
                                </button>
                            </div>
                        </div>

                        <!-- Results Panel -->
                        <div class="lg:col-span-2">
                            <div id="results" class="hidden">
                                <!-- Results will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Moderation Section -->
            <div id="moderation-section" class="section hidden">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-2xl font-semibold text-gray-900 mb-6">Content Moderation</h2>
                    <p class="text-gray-600">Moderation features will be available here.</p>
                </div>
            </div>

            <!-- Analytics Section -->
            <div id="analytics-section" class="section hidden">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h2 class="text-2xl font-semibold text-gray-900 mb-6">Analytics</h2>
                    <p class="text-gray-600">Analytics dashboard will be available here.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        const API_URL = 'http://localhost:4001';

        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(sectionName + '-section').classList.remove('hidden');
        }

        async function generateContent() {
            const btn = document.getElementById('generateBtn');
            const results = document.getElementById('results');
            
            // Get form values
            const topic = document.getElementById('topic').value;
            const pipeline = document.getElementById('pipeline').value;
            const numTerms = parseInt(document.getElementById('numTerms').value);
            const definitionStyle = document.getElementById('definitionStyle').value;
            const termSelectionLevel = document.getElementById('termSelectionLevel').value;
            const definitionComplexityLevel = document.getElementById('definitionComplexityLevel').value;
            const numExamples = parseInt(document.getElementById('numExamples').value);
            const numFacts = parseInt(document.getElementById('numFacts').value);
            const sentenceRange = document.getElementById('sentenceRange').value;
            const domainContext = document.getElementById('domainContext').value;
            const language = document.getElementById('language').value;
            
            // Get advanced toggles
            const useAnalogy = document.getElementById('useAnalogy').checked;
            const includeSynonyms = document.getElementById('includeSynonyms').checked;
            const includeAntonyms = document.getElementById('includeAntonyms').checked;
            const includeRelatedTerms = document.getElementById('includeRelatedTerms').checked;
            const includeEtymology = document.getElementById('includeEtymology').checked;
            const highlightRootWords = document.getElementById('highlightRootWords').checked;

            // Show loading state
            btn.disabled = true;
            btn.innerHTML = 'Generating...';
            results.classList.add('hidden');

            try {
                const response = await fetch(`${API_URL}/generate`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        topic,
                        numTerms,
                        definitionStyle,
                        sentenceRange,
                        numExamples,
                        numFacts,
                        termSelectionLevel,
                        definitionComplexityLevel,
                        domainContext,
                        language,
                        useAnalogy,
                        includeSynonyms,
                        includeAntonyms,
                        includeRelatedTerms,
                        includeEtymology,
                        highlightRootWords,
                        openAiFirst: pipeline === 'openai-first',
                        // Admin user for saving to database (topic will be created dynamically)
                        userId: 'admin-user-123',
                        userTier: 'premium'
                    }),
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                displayResults(data);
                
            } catch (error) {
                console.error('Error:', error);
                results.innerHTML = `
                    <div class="bg-red-50 border border-red-200 rounded-md p-4">
                        <div class="flex">
                            <i data-lucide="x-circle" class="w-5 h-5 text-red-400 mr-3"></i>
                            <div>
                                <h3 class="text-sm font-medium text-red-800">Error</h3>
                                <div class="mt-2 text-sm text-red-700">${error.message}</div>
                            </div>
                        </div>
                    </div>
                `;
                results.classList.remove('hidden');
                lucide.createIcons();
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'Generate Content';
            }
        }

        function displayResults(data) {
            const results = document.getElementById('results');
            
            if (!data.success) {
                results.innerHTML = `
                    <div class="bg-red-50 border border-red-200 rounded-md p-4">
                        <div class="flex">
                            <i data-lucide="x-circle" class="w-5 h-5 text-red-400 mr-3"></i>
                            <div>
                                <h3 class="text-sm font-medium text-red-800">Generation Failed</h3>
                                <div class="mt-2 text-sm text-red-700">${data.error || 'Unknown error'}</div>
                            </div>
                        </div>
                    </div>
                `;
                results.classList.remove('hidden');
                lucide.createIcons();
                return;
            }

            const result = data.data;
            
            // Get current form values for display
            const definitionStyle = document.getElementById('definitionStyle').value;
            const termSelectionLevel = document.getElementById('termSelectionLevel').value;
            const definitionComplexityLevel = document.getElementById('definitionComplexityLevel').value;
            const domainContext = document.getElementById('domainContext').value;
            const language = document.getElementById('language').value;
            const useAnalogy = document.getElementById('useAnalogy').checked;
            const includeSynonyms = document.getElementById('includeSynonyms').checked;
            const includeAntonyms = document.getElementById('includeAntonyms').checked;
            const includeRelatedTerms = document.getElementById('includeRelatedTerms').checked;
            const includeEtymology = document.getElementById('includeEtymology').checked;
            const highlightRootWords = document.getElementById('highlightRootWords').checked;
            
            // Stats
            const statsHtml = `
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center">
                        <i data-lucide="check-circle" class="w-5 h-5 mr-2 text-green-500"></i>
                        Generation Results
                    </h3>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-blue-600">${result.stats.termsGenerated}</div>
                            <div class="text-sm text-blue-800">Terms Generated</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-green-600">${result.stats.factsGenerated}</div>
                            <div class="text-sm text-green-800">Facts Generated</div>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-yellow-600">${result.stats.duplicatesRemoved}</div>
                            <div class="text-sm text-yellow-800">Duplicates Removed</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <div class="text-2xl font-bold text-purple-600">${result.stats.processingTime}ms</div>
                            <div class="text-sm text-purple-800">Processing Time</div>
                        </div>
                    </div>

                    <div class="text-sm text-gray-600">
                        <p><strong>Topic:</strong> ${result.topic}</p>
                        <p><strong>Pipeline:</strong> ${result.pipeline}</p>
                        <p><strong>Definition Style:</strong> ${definitionStyle}</p>
                        <p><strong>Term Level:</strong> ${termSelectionLevel}</p>
                        <p><strong>Definition Complexity:</strong> ${definitionComplexityLevel}</p>
                        <p><strong>Domain Context:</strong> ${domainContext}</p>
                        <p><strong>Language:</strong> ${language}</p>
                        <p><strong>Generated:</strong> ${new Date(data.timestamp).toLocaleString()}</p>
                    </div>
                    
                    <div class="mt-4 p-3 bg-gray-50 rounded-md">
                        <h5 class="font-medium text-gray-900 mb-2">Advanced Options Used:</h5>
                        <div class="text-sm text-gray-600 space-y-1">
                            ${useAnalogy ? '<p>✓ Include Analogies</p>' : ''}
                            ${includeSynonyms ? '<p>✓ Include Synonyms</p>' : ''}
                            ${includeAntonyms ? '<p>✓ Include Antonyms</p>' : ''}
                            ${includeRelatedTerms ? '<p>✓ Include Related Terms</p>' : ''}
                            ${includeEtymology ? '<p>✓ Include Etymology</p>' : ''}
                            ${highlightRootWords ? '<p>✓ Highlight Root Words</p>' : ''}
                        </div>
                    </div>
                </div>
            `;

            // Terms
            const termsHtml = result.terms.map(term => `
                <div class="border border-gray-200 rounded-lg p-4 mb-4">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="text-lg font-semibold text-gray-900">${term.term}</h4>
                        <div class="flex items-center space-x-2">
                            ${term.analogy ? '<span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">With Analogy</span>' : ''}
                            ${term.etymology ? '<span class="text-xs bg-green-100 text-green-800 px-2 py-1 rounded">Etymology</span>' : ''}
                        </div>
                    </div>
                    
                    <p class="text-gray-700 mb-3">${term.definition}</p>
                    
                    ${term.examples && term.examples.length > 0 ? 
                        `<div class="mb-3">
                            <h5 class="text-sm font-medium text-gray-900 mb-1">Examples:</h5>
                            ${term.examples.map(example => `<p class="text-sm text-gray-600 italic ml-2">"${example}"</p>`).join('')}
                        </div>` : 
                        ''
                    }
                    
                    ${term.analogy ? 
                        `<div class="bg-blue-50 p-3 rounded-md mb-3">
                            <p class="text-sm text-blue-800"><strong>Analogy:</strong> ${term.analogy}</p>
                        </div>` : 
                        ''
                    }
                    
                    ${term.etymology ? 
                        `<div class="bg-green-50 p-3 rounded-md mb-3">
                            <p class="text-sm text-green-800"><strong>Etymology:</strong> ${term.etymology}</p>
                        </div>` : 
                        ''
                    }
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-xs text-gray-500">
                        ${term.synonyms && term.synonyms.length > 0 ? 
                            `<div>
                                <strong>Synonyms:</strong> ${term.synonyms.join(', ')}
                            </div>` : 
                            ''
                        }
                        
                        ${term.antonyms && term.antonyms.length > 0 ? 
                            `<div>
                                <strong>Antonyms:</strong> ${term.antonyms.join(', ')}
                            </div>` : 
                            ''
                        }
                        
                        ${term.relatedTerms && term.relatedTerms.length > 0 ? 
                            `<div>
                                <strong>Related Terms:</strong> ${term.relatedTerms.join(', ')}
                            </div>` : 
                            ''
                        }
                        
                        ${term.rootWords && term.rootWords.length > 0 ? 
                            `<div>
                                <strong>Root Words:</strong> ${term.rootWords.join(', ')}
                            </div>` : 
                            ''
                        }
                    </div>
                </div>
            `).join('');

            // Facts - Handle both string array and object array formats
            const factsHtml = result.facts && result.facts.length > 0 ? `
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Generated Facts</h3>
                    <div class="space-y-3">
                        ${result.facts.map((fact, index) => {
                            // Handle both string and object formats
                            const factText = typeof fact === 'string' ? fact : (fact.fact || fact);
                            const factTopic = typeof fact === 'object' ? (fact.topic || result.topic) : result.topic;
                            const factConfidence = typeof fact === 'object' ? (fact.confidence || 'N/A') : 'N/A';
                            const factSource = typeof fact === 'object' ? (fact.source || 'AI Generated') : 'AI Generated';
                            
                            return `
                                <div class="border border-gray-200 rounded-lg p-4">
                                    <p class="text-gray-700 mb-2">${factText}</p>
                                    <div class="flex justify-between text-xs text-gray-500">
                                        <span>Topic: ${factTopic}</span>
                                        <span>Confidence: ${factConfidence}%</span>
                                        <span>Source: ${factSource}</span>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
            ` : '';

            results.innerHTML = `
                ${statsHtml}
                <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Generated Terms</h3>
                    ${termsHtml}
                </div>
                ${factsHtml}
            `;
            
            results.classList.remove('hidden');
            lucide.createIcons();
        }

        // Show generate section by default
        showSection('generate');
    </script>
</body>
</html>
